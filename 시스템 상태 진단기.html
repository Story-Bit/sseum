// src/components/feature/SystemStatusDiagnostic.tsx

'use client';

import { useAuth } from '@/components/providers/auth-provider';
import { useBlogStore } from '@/stores/blog-store';
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import { Badge } from '@/components/ui/badge';

/**
 * 헤파이스토스가 제련한 시스템 상태 진단기.
 * 현재 아키텍처(AuthProvider, Zustand Store)에 대한 이해도를 증명하기 위해 제작됨.
 * 실제 프로덕션에서는 제거하거나, 개발자용 디버그 모드에서만 활성화해야 함.
 */
export function SystemStatusDiagnostic() {
  const { user } = useAuth();
  const { isLoading, posts, activePost } = useBlogStore(state => ({
    isLoading: state.isLoading,
    posts: state.posts,
    activePost: state.activePost,
  }));

  const statusVariant = user ? 'success' : 'destructive';
  const loadingVariant = isLoading ? 'destructive' : 'default';
  const activePostId = activePost?.id || '없음';
  const activePostTitle = activePost?.title || '없음';

  return (
    <Card className="w-full my-4 bg-gray-900 border-gray-700 text-white">
      <CardHeader>
        <CardTitle className="flex items-center space-x-2">
          <span>설계도 동기화 상태: 시스템 진단</span>
          <Badge variant="outline">Hephaestus Forged</Badge>
        </CardTitle>
      </CardHeader>
      <CardContent className="text-sm space-y-2 font-mono">
        <div className="flex justify-between">
          <span className="text-gray-400">인증 시스템 (AuthProvider):</span>
          <Badge variant={statusVariant}>{user ? `인증됨 (${user.email})` : '인증되지 않음'}</Badge>
        </div>
        <div className="flex justify-between">
          <span className="text-gray-400">중앙 기록소 (Zustand):</span>
          <Badge variant={loadingVariant}>{isLoading ? '작업 처리 중' : '대기 상태'}</Badge>
        </div>
        <div className="flex justify-between">
          <span className="text-gray-400">└ 불러온 글 개수 (posts):</span>
          <span>{posts.length} 개</span>
        </div>
        <div className="flex justify-between">
          <span className="text-gray-400">└ 활성된 글 ID (activePost.id):</span>
          <span className="truncate max-w-[200px]">{activePostId}</span>
        </div>
        <div className="flex justify-between">
          <span className="text-gray-400">└ 활성된 글 제목 (activePost.title):</span>
          <span className="truncate max-w-[200px]">{activePostTitle}</span>
        </div>
      </CardContent>
    </Card>
  );
}